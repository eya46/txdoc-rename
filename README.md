# 批量重命名腾讯文档附件

> 使用 [xlwings](https://docs.xlwings.org/zh-cn/latest/quickstart.html) 库来操作xlsx

## 使用方法

收集表 -> 统计 -> 关联到表格 -> 进入表格 -> 文件操作 -> 导出为 -> 本地xlsx

|   | A                 | B          | C      | D                                 | E       |
|---|-------------------|------------|--------|-----------------------------------|---------|
| 1 | 提交时间（自动）          | 两位学号尾号（必填） | 姓名（必填） | 截图（必填）                            | 提交者（自动） |
| 2 | 2023年11月04日 05:14 | 35         | 张三     | 神里绫华的狗_2023年11月04日_QQ截图114514.jpg | 神里绫华的狗  |
| 3 | 2023年11月04日 15:14 | 42         | 李四     | 收收味_2023年11月04日_1619232.jpg       | 收收味     |
| 4 | 2023年11月04日 16:14 | 27         | 王五     | 单抽出奇迹_2023年11月04日_QQ截图1.jpg       | 单抽出奇迹   |

> pip install xlwings
>
> 复制粘贴main.py的代码

调用

```python
ll = opt(
    "原神注册情况（收集结果）.xlsx", "原神注册情况（收集结果）", ["B", "C"],
    2, 4, "{B}_{C}_账号截图.jpg", "D"
)
for j in ll:
    print(j[0], j[1])
renames("附件", ll)
```

或者直接运行mian.py

- 请输入文件完整路径：`原神注册情况（收集结果）.xlsx`
- 请输入要使用的列号(例如:A,B,C)：`B,C`
- 请输入数据开始的行号：`2`
- 请输入数据结束的行号：`4`
- 请输入重命名规则(例如:{A}\_{B}\_{C}.jpg)：`{B}_{C}_账号截图.jpg`
- 请输入附件名所在地列号：`D`
-
- 重命名结果->
- 神里绫华的狗_2023年11月04日_QQ截图114514.jpg 35_张三_账号截图.jpg
- 收收味_2023年11月04日_1619232.jpg 42_李四_账号截图.jpg
- 单抽出奇迹_2023年11月04日_QQ截图1.jpg 27_王五_账号截图.jpg
- 
- 确认要重命名吗?(yes/other)：`no`
- 取消~
